--- hal.orig.c	2021-03-11 11:34:53.000000000 +0100
+++ hal.c	2021-03-11 11:44:40.000000000 +0100
@@ -32,9 +32,9 @@
 
 WINE_DEFAULT_DEBUG_CHANNEL(ntoskrnl);
 
-#ifdef __i386__
+#if defined(__i386__) || defined(__i386_on_x86_64__)
 
-#ifndef _WIN32
+#if !defined(_WIN32) && !defined(__i386_on_x86_64__)
 
 extern void * WINAPI wrap_fastcall_func1( void *func, const void *a );
 __ASM_STDCALL_FUNC( wrap_fastcall_func1, 8,
@@ -120,7 +120,7 @@
 }
 #endif /* __i386__ */
 
-#if defined(__i386__) || defined(__arm__) || defined(__aarch64__)
+#if defined(__i386__) || defined(__i386_on_x86_64__) || defined(__arm__) || defined(__aarch64__)
 
 DEFINE_FASTCALL1_WRAPPER( KfLowerIrql )
 VOID FASTCALL KfLowerIrql(KIRQL NewIrql)
